---
// src/layouts/AuthGuard.astro


const { requiredRoles } = Astro.props; 


const token = Astro.cookies.get('token')?.value;
const userRole = Astro.cookies.get('role')?.value;


if (!token || !userRole) {
  return Astro.redirect('/login', 307); 
}

if (requiredRoles && !requiredRoles.includes(userRole)) {
  return Astro.redirect('/login', 307);
}

---